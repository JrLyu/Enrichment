---
title: "Approximations to the Normal"
author: "Jiuru Lyu"
date: "11/16/2023"
output:
  html_document:
    df_print: paged
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(pandoc)
pandoc_activate(
  version = "latest",
  rmarkdown = getOption("pandoc.activate_rmarkdown", TRUE),
  quiet = FALSE
)
```

## Distributions in R
- `d` is for density
- `p` is for probability
- `q` is for quantile
- `r` is for random

## Drawing Random Samples in R
- `runif` for uniform
- `rexp` for exponential
- `rnorm` for normal
- `rbinom` for binomial
- `rpois` for Poisson
```{r}
# default range is 1
u <- runif(20) # 20 random numbers from a uniform distribution
hist(u)
```

```{r}
x = rnorm(500, mean=100, sd=10) # 500 random numbers from a normal distribution with mean 100 and sd 10
hist(x, prob=TRUE)
```

```{r}
x = rbinom(50000, n=100, p=.3) # 1000 random numbers from a binomial distribution with n=100 and p=.3
hist(x, prob=TRUE)
```

Recall how we derived the Possoin distribution.
$$
X\sim\text{Poisson}(\lambda)
$$

$$
Z\sim\dfrac{X-\lambda}{\sqrt{\lambda}}
$$
```{r}
x = rpois(50000, lambda=100) # 1000 random numbers from a Poisson distribution with lambda=10
hist(x, prob=TRUE)
curve(dnorm(x, mean=100, sd=10), 70, 130, add=TRUE, lwd=2, col="red") # plot the normal density with mean 100 and sd 10
```

$X\sim$ omething that can be written as a sum or $\text{Normal}(\mu,\sigma^2)$, then
$$
Z\approx\dfrac{X-\mu}{\sigma}
$$

## Sample Means, Their Distribution, and the Central Limit Theorem
```{r}
x = dnorm(x, mean=100, sd=10)
mean(x)
```
**Each time we will get a different number unless we set the *seed*!**

```{r}
# Initialize a vector
xbar <- rep(0, 500)

# Set the parameters
n <- 5
mu <- 100
sd <- 10

# Use the for loop to get the sample means
for (i in 1:500) {
    xbar[i] <- mean(rnorm(n, mu, sd))
}

# Plot the histogram
hist(xbar, prob=TRUE)
```

```{r}
# Repeat the same thing with a Exponent Distribution

xbar <- rep(0, 500)
n <- 100

for (i in 1:500) {
    xbar[i] <- mean(rexp(n, rate=1))
}

hist(xbar, prob=TRUE, breaks=12)
```

For large $n$, $X\sim\text{Binomial}(n,p)$ seems normal.
```{r}
x <- rbinom(100, n=100, p=.3)
hist(x, prob=TRUE)
```

$X\sim\text{Binomial}(n,p)$ where $n$ is large, then
$$
Z=\dfrac{1}{\sqrt{np(1-p)}}(X-np)\approx\text{Normal}(0,1)
$$
```{r}
z <- (x-100*0.3) / sqrt(100*0.3*0.7)
hist(z, prob=TRUE)
curve(dnorm(x, mean=0, sd=1), -3, 3, add=TRUE, lwd=2, col="blue")
```

When $\lambda$ is large, $Y\sim\text{Poisson}(\lambda)$ seems normal.
```{r}
n <- 100
lambda <- 100
y <- rpois(n, lambda)
hist(y, prob=TRUE)
```

**Interesting Observation**: The Poisson distribution is skewed to the right, so if we have small $\lambda$, then the distribution is skewed to the right. However, if we have large $\lambda$, then the distribution is skewed to the left.

$Y\sim\text{Poisson}(\lambda)$ where $\lambda$ is large, then
$$
Z=\dfrac{Y-\lambda}{\sqrt{\lambda}}\approx\text{Normal}(0,1)
$$

